#include <Servo.h>

Servo esc1;
Servo esc2;
int rpm = 1000;         // Current RPM of the motor
int targetRpm = 1000;   // Target RPM entered by the user

void setup() {
  Serial.begin(9600);
  pinMode(9, OUTPUT);
  pinMode(10, OUTPUT);
  esc1.attach(9, 1000, 2000);    // Attach ESC to pin 9
  esc2.attach(10, 1000, 2000);   // Attach ESC to pin 10
  esc1.write(1000);              // Start at minimum speed
  esc2.write(1000);
  delay(2000);                   // Wait for ESC to initialize
  Serial.println("Enter target RPM between 1000 and 2000: ");
}

void loop() {
  
  if (Serial.available() > 0) {
    targetRpm = Serial.parseInt();

    // Validate the target RPM range
    if (targetRpm >= 1000 && targetRpm <= 2000) {
      Serial.print("Target RPM set to: ");
      Serial.println(targetRpm);
    } else {
      Serial.println("Invalid input. Enter a value between 1000 and 2000.");
    }
  }


  // Gradually adjust RPM to match the target RPM
  int i=0;
  if (rpm < targetRpm) {
    
    for(i=rpm ; i<=targetRpm; i++){
      //rpm += 1; 
      esc1.write(i);
      delay(50);
      Serial.println(i);

    }
    
  } else if (rpm > targetRpm) {
    for(i=rpm ; i>=targetRpm ; i--){
     // rpm -= 1; 
      esc1.write(i);
      delay(50);
      Serial.println(i);
      
    }

  }else{
    esc1.write(rpm);
    esc2.write(rpm);

  }
  rpm = targetRpm;

  // Write the adjusted RPM to the ESCs
  //esc1.write(targetRpm);
  //esc2.write(targetRpm);

  // Print the current RPM for monitoring
  Serial.print("Current RPM: ");
  Serial.println(rpm);

  delay(50); // Small delay for smooth RPM transition
}
